\documentclass[12pt,twoside]{report}

\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{csquotes}
\usepackage{geometry}
\usepackage[pdftex,unicode,colorlinks=true,linkcolor=blue,urlcolor=blue]{hyperref}
\usepackage[style=numeric,citestyle=alphabetic,sorting=none,backend=biber]{biblatex}
\usepackage{indentfirst}
\usepackage{etoolbox}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{subcaption}
\usepackage{mdframed}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage[pagestyles]{titlesec}
\usepackage{fancyhdr}

% remove "Chapter N" from chapter layout
\titleformat{\chapter}[display]{\normalfont\bfseries}{}{0pt}{\Huge}
\newpagestyle{mystyle}
{\sethead[\thepage][][\chaptertitle]{}{}{\thepage}}
\pagestyle{mystyle}

% set page headers and footers
\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{ \markboth{#1}{} }
\renewcommand{\sectionmark}[1]{ \markright{#1}{} }

\fancyhf{}
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{\textit{ \nouppercase{\leftmark}} }
\fancyhead[LO]{\textit{ \nouppercase{\rightmark}} }

\fancypagestyle{plain}{ %
  \fancyhf{} % remove everything
  \renewcommand{\headrulewidth}{0pt} % remove lines as well
  \renewcommand{\footrulewidth}{0pt}
}

\numberwithin{figure}{section}

\setlist{noitemsep}

\sloppy
\clubpenalty=999
\widowpenalty=9999

% remove vertical spaces before and after verbatim
\makeatletter

\preto{\@verbatim}{\topsep=0pt \partopsep=0pt }
\def\ScaleWidthIfNeeded{%
 \ifdim\Gin@nat@width>0.8\textwidth
    0.8\textwidth
  \else
    \Gin@nat@width
  \fi
}
\def\ScaleHeightIfNeeded{%
  \ifdim\Gin@nat@height>0.4\textheight
    0.4\textheight
  \else
    \Gin@nat@width
  \fi
}

\makeatother
\setkeys{Gin}{width=\ScaleWidthIfNeeded,height=\ScaleHeightIfNeeded,keepaspectratio}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\begin{document}

\begin{titlepage}
\begin{center}

% Upper part of the page. The '~' is needed because \\
% only works if a paragraph has started.
\includegraphics[width=0.2\textwidth]{images/msu}~\\[0.5cm]

\textsc{\large Московский Государственный Университет им.~М.~В.~Ломоносова}\\[0.3cm]
\textsc{\small
  факультет Вычислительной Математики и Кибернетики\\
  кафедра Алгоритмических Языков}\\[1.5cm]

% Title
\HRule \\[0.4cm]
{ \Large \bfseries Практические задания по курсу <<Программирование на языке Haskell>> \\[0.4cm] }

\HRule \\[1.5cm]

{\large Кудасов~Н.~Д.}

\vfill

% Bottom of the page
{\large \the\year~г.}

\end{center}
\end{titlepage}

% FIXME: clearpage вызывает замену sectionmark!
\newcommand{\sectionbreak}{\clearpage}

\setcounter{tocdepth}{1}
\tableofcontents

$body$

\end{document}
